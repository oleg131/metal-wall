(this.webpackJsonpmetal=this.webpackJsonpmetal||[]).push([[0],{12:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),o=n.n(c),l=(n(12),n(1)),s=n(5),i=n(6),u=n.n(i),m=n(2),h=n.n(m),f=(n(19),"https://cors-anywhere.herokuapp.com/");function d(){return r.a.createElement(g,null)}function g(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),i=Object(l.a)(o,2),u=i[0],m=i[1],d=Object(a.useState)(!0),g=Object(l.a)(d,2),b=g[0],v=g[1];function E(e){var t=e[2].match("\x3c!-- (.+) --\x3e")[1],n=document.createElement("html");n.innerHTML=e[0];var a=n.getElementsByTagName("a")[0].innerText,r=document.createElement("html");r.innerHTML=e[1];var c=r.getElementsByTagName("a")[0].innerText,o=r.getElementsByTagName("a")[0].getAttribute("href"),l=o.split("/").pop();return{url:o,id:l,cover:"https://www.metal-archives.com/images/".concat(l[0],"/").concat(l[1],"/").concat(l[2],"/").concat(l[3],"/").concat(l,"."),date:t,artist:a,album:c}}function w(e){var t=h()(),a=t.month()+1,r=t.year(),o=a,l=r,s=a,i=f+"https://www.metal-archives.com/search\n    /ajax-advanced/searching/albums/?bandName=&releaseTitle=\n    &releaseYearFrom=".concat(r-1,"&releaseMonthFrom=").concat(o,"\n    &releaseYearTo=").concat(l,"&releaseMonthTo=").concat(s,"\n    &country=&location=&releaseLabelName=&releaseCatalogNumber=&releaseIdentifiers=\n    &releaseRecordingInfo=&releaseDescription=&releaseNotes=&genre=&releaseType[]=1\n    &sEcho=1&iColumns=3&sColumns=&iDisplayStart=DISPLAYSTART\n    &iDisplayLength=200").replace(/\n/g,"").replace(/ /g,"");e?(console.log("fetch with start",e),fetch(i.replace("DISPLAYSTART",e)).then((function(e){return e.json()})).then((function(t){m(e-200),0!==t.aaData.length?((t=(t=t.aaData.map(E)).filter((function(e){return e.date<=h()().format("YYYY-MM-DD")}))).sort((function(e,t){return e.date<t.date})).reverse(),c(n.concat(t)),console.log("fetched",t.length)):v(!1)}))):(console.log("fetch initial"),fetch(i.replace("DISPLAYSTART",0)).then((function(e){return e.json()})).then((function(e){w(e.iTotalRecords-200)})))}return Object(a.useEffect)((function(){w(u)}),[]),r.a.createElement("main",{role:"main",className:"container-fluid text-center"},r.a.createElement(s.a,{dataLength:n.length,next:function(){return w(u)},hasMore:b,loader:"Loading",endMessage:"The end"},r.a.createElement("div",{className:"text-center"},n.map((function(e,t){return r.a.createElement(p,{data:e,key:t})})))))}function p(e){var t=e.data,n=Object(a.useState)("thumbnail zoom"),c=Object(l.a)(n,2),o=c[0],s=c[1];return r.a.createElement("div",{className:o},r.a.createElement("a",{href:"https://www.youtube.com/results?search_query="+t.artist+" "+t.album,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(u.a,{src:t.cover+"jpg",fallbackImage:[t.cover+"jpeg",r.a.createElement(b,{onLoad:function(){return s(o+" empty-thumbnail")}})],className:"thumbnail-image"})))}function b(e){var t=e.onLoad;return Object(a.useEffect)((function(){return t()})),r.a.createElement(a.Fragment,null)}var v=function(){return r.a.createElement("div",null,r.a.createElement(d,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(20);o.a.render(r.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports=n(21)}},[[7,1,2]]]);
//# sourceMappingURL=main.69c6ce58.chunk.js.map