(this.webpackJsonpmetal=this.webpackJsonpmetal||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),o=n.n(c),l=n(1),i=n(5),s=n(6),u=n.n(s),m=n(2),h=n.n(m),f=(n(18),"https://cors-anywhere.herokuapp.com/"),d=120;function g(){return r.a.createElement("div",{className:"text-center my-5"},r.a.createElement("h2",{className:"header"},"Wall of latest metal releases. Powered by Metal Archives, YouTube and React."))}function w(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),s=Object(l.a)(o,2),u=s[0],m=s[1],g=Object(a.useState)(!0),w=Object(l.a)(g,2),p=w[0],b=w[1];function E(e){var t=h()(),a=t.month()+1,r=t.year(),o=a,l=r,i=a,s=f+"https://www.metal-archives.com/search\n    /ajax-advanced/searching/albums/?bandName=&releaseTitle=\n    &releaseYearFrom=".concat(r-1,"&releaseMonthFrom=").concat(o,"\n    &releaseYearTo=").concat(l,"&releaseMonthTo=").concat(i,"\n    &country=&location=&releaseLabelName=&releaseCatalogNumber=&releaseIdentifiers=\n    &releaseRecordingInfo=&releaseDescription=&releaseNotes=&genre=&releaseType[]=1\n    &sEcho=1&iColumns=3&sColumns=&iDisplayStart=DISPLAYSTART\n    &iDisplayLength=").concat(200).replace(/\n/g,"").replace(/ /g,"");e?(console.log("fetch with start",e),fetch(s.replace("DISPLAYSTART",e)).then((function(e){return e.json()})).then((function(t){if(m(e-200),0!==t.aaData.length){(t=(t=t.aaData.map(T).filter((function(e){return!!e}))).filter((function(e){return e.date<=h()().format("YYYY-MM-DD")}))).sort((function(e,t){return e.date<t.date})).reverse(),t=n.concat(t),c(t),console.log("fetched",t.length);var a=Math.floor(window.innerWidth/d)*Math.ceil(2*window.innerHeight/d);t.length<a&&E(e-200)}else b(!1)}))):(console.log("fetch initial"),fetch(s.replace("DISPLAYSTART",0)).then((function(e){return e.json()})).then((function(e){E(e.iTotalRecords-200)})))}function T(e){var t=e[2].match("\x3c!-- (.+) --\x3e");if(!t)return null;var n=t[1],a=document.createElement("html");a.innerHTML=e[0];var r=a.getElementsByTagName("a")[0].innerText,c=document.createElement("html");c.innerHTML=e[1];var o=c.getElementsByTagName("a")[0].innerText,l=c.getElementsByTagName("a")[0].getAttribute("href"),i=l.split("/").pop();return{url:l,id:i,cover:"https://www.metal-archives.com/images/".concat(i[0],"/").concat(i[1],"/").concat(i[2],"/").concat(i[3],"/").concat(i,"."),date:n,artist:r,album:o}}return Object(a.useEffect)((function(){E(u)}),[]),r.a.createElement("main",{role:"main",className:"container-fluid text-center px-0"},r.a.createElement(i.a,{dataLength:n.length,next:function(){return E(u)},hasMore:p,loader:"Loading",endMessage:"The End (These are albums for the past year. Enjoy!)"},r.a.createElement("div",{className:"text-center"},n.map((function(e,t){return r.a.createElement(v,{data:e,key:t})})))))}function v(e){var t=e.data,n=Object(a.useState)("thumbnail zoom"),c=Object(l.a)(n,2),o=c[0],i=c[1],s=function(){var e=Object(a.useState)(window.innerWidth),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=function(){return r(window.innerWidth)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}})),n/Math.floor(n/d)}();return r.a.createElement("div",{className:o,style:{width:s,height:s}},r.a.createElement("a",{href:"https://www.youtube.com/results?search_query="+t.artist+" "+t.album,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(u.a,{src:t.cover+"jpg",fallbackImage:[t.cover+"jpeg",r.a.createElement(p,{onLoad:function(){return i(o+" empty")}})],className:"thumbnail-image"})))}function p(e){var t=e.onLoad;return Object(a.useEffect)(t),r.a.createElement(a.Fragment,null)}var b=function(){return r.a.createElement("div",null,r.a.createElement(g,null),r.a.createElement(w,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(19),n(20);o.a.render(r.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports=n(21)}},[[7,1,2]]]);
//# sourceMappingURL=main.30bdfa00.chunk.js.map